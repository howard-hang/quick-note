# Mock API Server - UI 设计草稿

## 概述
Mock API Server 的 UI 设计采用类似 Postman 的风格,提供直观、专业的接口管理界面。

## 整体布局

### 工具窗口位置
- **位置**: 底部面板 (Bottom)
- **标题**: Mock API
- **可折叠**: 是
- **可浮动**: 是

## 主界面布局

```
┌────────────────────────────────────────────────────────────────────────────┐
│ Server: ● Running | http://192.168.1.100:8888                             │
│ [Copy URL] [Show Addresses] [Stop Server] [⚙️ Settings]                   │
├──────────────────┬─────────────────────────┬───────────────────────────────┤
│                  │                         │                               │
│  Endpoints       │  Endpoint Details       │  Request Log                  │
│                  │                         │                               │
│  [+ Add][-][↻]   │  Name: Get Users        │  ┌─────────────────────────┐ │
│                  │  Method: GET            │  │ Time | Method | Path    │ │
│  ┌────────────┐  │  Path: /api/users       │  │ 14:30| GET   | /api/.. │ │
│  │ [GET]      │  │  Status: 200            │  │ 14:29| POST  | /api/.. │ │
│  │ /api/users │  │  Enabled: ✓ Yes         │  │ 14:28| GET   | /api/.. │ │
│  │ ● Get Users│  │                         │  └─────────────────────────┘ │
│  └────────────┘  │  Response Body:         │                               │
│                  │  ┌───────────────────┐  │  [Clear History]              │
│  ┌────────────┐  │  │ {                 │  │                               │
│  │ [POST]     │  │  │   "users": [      │  │                               │
│  │ /api/users │  │  │     {             │  │                               │
│  │ ● Create   │  │  │       "id": 1,    │  │                               │
│  └────────────┘  │  │       "name": "A" │  │                               │
│                  │  │     }             │  │                               │
│  ┌────────────┐  │  │   ]               │  │                               │
│  │ [DELETE]   │  │  │ }                 │  │                               │
│  │ /api/users │  │  └───────────────────┘  │                               │
│  │ ○ Disabled │  │                         │                               │
│  └────────────┘  │  [Edit] [Delete]        │                               │
│                  │                         │                               │
└──────────────────┴─────────────────────────┴───────────────────────────────┘
```

## 组件详细设计

### 1. 服务器控制面板 (顶部)

#### 1.1 服务器状态区域 (左侧)
- **服务器状态标签**
  - 运行中: `Server: ● Running` (绿色)
  - 已停止: `Server: ● Stopped` (红色)
  - 字体: 加粗

- **网络地址显示**
  - 格式: `| http://192.168.1.100:8888`
  - 仅在运行时显示
  - 颜色: 普通文本

#### 1.2 操作按钮区域 (右侧)
- **Copy URL 按钮**
  - 图标: 复制图标
  - 功能: 复制服务器地址到剪贴板
  - 状态: 仅在服务器运行时启用

- **Show Addresses 按钮**
  - 图标: 预览图标
  - 功能: 显示所有网络地址对话框
  - 状态: 仅在服务器运行时启用

- **Start/Stop Server 按钮**
  - 未运行时:
    - 文本: "Start Server"
    - 图标: 执行图标 (绿色播放)
  - 运行时:
    - 文本: "Stop Server"
    - 图标: 暂停图标 (红色)

- **Settings 按钮**
  - 图标: 齿轮图标
  - 功能: 打开服务器设置对话框
  - 状态: 始终启用

### 2. 端点列表面板 (左侧, 25% 宽度)

#### 2.1 标题栏
- 文本: "Endpoints"
- 字体: 加粗
- 工具栏:
  - **Add 按钮** (+): 添加新端点
  - **Edit 按钮**: 编辑选中端点 (需选中)
  - **Delete 按钮**: 删除选中端点 (需选中)

#### 2.2 端点列表项设计
每个端点显示为一个卡片,包含:

```
┌────────────────────────────┐
│ [GET]  Get Users      ●    │
│        /api/users           │
│        Status: 200          │
└────────────────────────────┘
```

**组件说明**:
- **HTTP 方法徽章** (左侧)
  - 显示: 方法名称 (GET, POST, PUT, DELETE等)
  - 样式: 圆角矩形背景
  - 颜色编码:
    - GET: 蓝色 (#61AFFE)
    - POST: 绿色 (#49CC90)
    - PUT: 橙色 (#FCA130)
    - DELETE: 红色 (#F93E3E)
    - PATCH: 青色 (#50E3C2)
    - OPTIONS: 紫色 (#9012FE)
    - HEAD: 灰色 (#7D7D7D)
  - 字体: 白色加粗, 10px

- **端点名称** (标题行)
  - 字体: 加粗, 13px
  - 颜色: 主文本色

- **启用状态指示器**
  - 已启用: ● (绿色圆点)
  - 已禁用: ○ (灰色空心圆)
  - 位置: 名称右侧

- **路径**
  - 字体: 普通, 11px
  - 颜色: 灰色

- **状态码**
  - 格式: "Status: 200"
  - 字体: 普通, 10px
  - 颜色: 灰色

**交互**:
- 点击选中: 显示详情
- 双击: 编辑端点

### 3. 端点详情面板 (中间, 45% 宽度)

#### 3.1 标题
- 文本: "Endpoint Details"
- 字体: 加粗

#### 3.2 表单字段 (只读显示)

**布局**: 两列表单布局

| 字段名 | 字段值 | 说明 |
|--------|--------|------|
| Name | [文本框] | 端点名称 |
| Method | [标签] | HTTP 方法 (加粗,带颜色) |
| Status | [文本框] | HTTP 状态码 (同行右侧) |
| Path | [文本框] | API 路径 |
| Enabled | [标签] | ✓ Yes (绿色) 或 ✗ No (红色) |
| Response Body | [文本区域] | JSON 响应体 (占据剩余空间) |

**响应体文本区域**:
- 高度: 占据面板剩余垂直空间
- 字体: 等宽字体
- 自动换行: 是
- 滚动条: 垂直自动
- 只读: 是

#### 3.3 操作按钮 (底部)
- **Edit 按钮**: 编辑当前端点
- **Delete 按钮**: 删除当前端点

### 4. 请求日志面板 (右侧, 30% 宽度)

#### 4.1 标题栏
- 文本: "Request Log"
- 字体: 加粗
- **Clear History 按钮** (右侧)
  - 图标: 垃圾桶图标
  - 功能: 清空请求历史

#### 4.2 请求历史表格
**列定义**:
1. **Time**: 时间 (HH:mm:ss)
2. **Method**: HTTP 方法
3. **Path**: 请求路径
4. **Status**: 响应状态码
5. **Response Time (ms)**: 响应时间

**表格特性**:
- 自动滚动到最新请求
- 最多显示 100 条记录
- 自动刷新: 每 2 秒
- 填充视口高度

## 对话框设计

### 1. 添加/编辑端点对话框 (Add/Edit Endpoint)

**尺寸**: 700px × 600px

**表单字段**:
```
┌─────────────────────────────────────────┐
│ Add Mock Endpoint                  [X]  │
├─────────────────────────────────────────┤
│                                         │
│  Name: [____________________________]   │
│                                         │
│  HTTP Method: [GET ▼]                   │
│                                         │
│  Path: [____________________________]   │
│                                         │
│  Status Code: [200_____]                │
│                                         │
│  Response Delay (ms): [0_______]        │
│                                         │
│  ☑ Enabled                              │
│                                         │
│  Description:                           │
│  ┌───────────────────────────────────┐  │
│  │                                   │  │
│  └───────────────────────────────────┘  │
│                                         │
│  ────────────────────────────────────   │
│                                         │
│  Response Body (JSON):                  │
│  ┌───────────────────────────────────┐  │
│  │ {                                 │  │
│  │   "id": 1,                        │  │
│  │   "name": "John Doe"              │  │
│  │ }                                 │  │
│  │                                   │  │
│  │                                   │  │
│  └───────────────────────────────────┘  │
│                                         │
│             [Cancel]  [OK]              │
└─────────────────────────────────────────┘
```

**字段验证**:
- Name: 必填
- Path: 必填,必须以 / 开头
- Status Code: 100-599
- Response Delay: ≥ 0
- Response Body: 有效 JSON (如果非空)

### 2. 服务器设置对话框 (Mock API Server Settings)

**尺寸**: 500px × 200px

**表单字段**:
```
┌─────────────────────────────────────────┐
│ Mock API Server Settings           [X] │
├─────────────────────────────────────────┤
│                                         │
│  Server Port: [8888____]                │
│                                         │
│  Image Storage Path:                    │
│  [_________________________] [Browse]   │
│                                         │
│  ☑ Enable CORS (Cross-Origin Resource  │
│     Sharing)                            │
│                                         │
│  ☑ Enable Request Logging               │
│                                         │
│             [Cancel]  [OK]              │
└─────────────────────────────────────────┘
```

**字段验证**:
- Server Port: 1-65535
- Image Storage Path: 有效目录路径 (如果非空)

### 3. 网络地址对话框 (Network Addresses)

**尺寸**: 600px × 300px

**布局**:
```
┌─────────────────────────────────────────┐
│ Mock API Network Addresses         [X] │
├─────────────────────────────────────────┤
│                                         │
│  The Mock API server is accessible at  │
│  the following addresses:               │
│                                         │
│  http://localhost:8888      [Copy]      │
│  http://192.168.1.100:8888  [Copy]      │
│  http://192.168.56.1:8888   [Copy]      │
│                                         │
│  ────────────────────────────────────   │
│                                         │
│  Usage:                                 │
│  • Use any address above to access the  │
│    Mock API from devices on the same    │
│    network                              │
│  • Localhost addresses work only on     │
│    this computer                        │
│  • LAN addresses (192.168.x.x) work on  │
│    the local network                    │
│  • Example curl command:                │
│    curl http://[address]/api/endpoint   │
│                                         │
│                      [Close]            │
└─────────────────────────────────────────┘
```

## 颜色方案

### HTTP 方法颜色 (Postman 风格)
- **GET**: `#61AFFE` (蓝色)
- **POST**: `#49CC90` (绿色)
- **PUT**: `#FCA130` (橙色)
- **DELETE**: `#F93E3E` (红色)
- **PATCH**: `#50E3C2` (青色)
- **OPTIONS**: `#9012FE` (紫色)
- **HEAD**: `#7D7D7D` (灰色)

### 状态颜色
- **运行中**: 绿色 (JBColor.GREEN)
- **已停止**: 红色 (JBColor.RED)
- **已启用**: 绿色
- **已禁用**: 灰色

### UI 元素颜色
- **主文本**: 系统默认 (JBColor)
- **次要文本**: 灰色 (JBColor.GRAY)
- **选中背景**: 系统选中色
- **边框**: 系统边框色

## 字体规范

| 元素 | 字体 | 大小 | 样式 |
|------|------|------|------|
| 面板标题 | 系统默认 | 默认 | 加粗 |
| 端点名称 | 系统默认 | 13px | 加粗 |
| HTTP 方法徽章 | 系统默认 | 10px | 白色加粗 |
| 路径文本 | 系统默认 | 11px | 普通 |
| 状态码 | 系统默认 | 10px | 普通 |
| 详情字段 | 系统默认 | 默认 | 普通 |
| 响应体 | 等宽字体 | 默认 | 普通 |

## 间距规范

- **面板内边距**: 8px
- **组件间距**: 4-10px
- **按钮间距**: 5px
- **表单行间距**: 4px
- **边框圆角**: 4px (卡片元素)

## 交互行为

### 端点列表
- **点击**: 选中并显示详情
- **双击**: 打开编辑对话框
- **右键**: (未实现) 显示上下文菜单

### 服务器控制
- **Start Server**:
  - 验证配置
  - 检查端口可用性
  - 启动服务器
  - 显示成功/失败消息

- **Stop Server**:
  - 停止服务器
  - 更新 UI 状态

### 端点操作
- **Add**: 打开添加对话框
- **Edit**: 打开编辑对话框 (需选中)
- **Delete**: 显示确认对话框 → 删除

### 实时更新
- **端点列表**: 监听 MockApiChangeListener,自动刷新
- **服务器状态**: 监听状态变化,自动更新
- **请求日志**: 每 2 秒自动刷新

## 无障碍特性

- 所有按钮有工具提示 (Tooltip)
- 表单字段有清晰标签
- 键盘导航支持
- 高对比度主题支持

## 响应式布局

- 三个面板使用 Splitter 组件,可调整宽度
- 最小宽度限制防止内容挤压
- 垂直空间自适应工具窗口高度

## 图标使用

所有图标使用 IntelliJ Platform 内置图标:
- 执行: `AllIcons.Actions.Execute`
- 暂停: `AllIcons.Actions.Suspend`
- 添加: `AllIcons.General.Add`
- 编辑: `AllIcons.Actions.Edit`
- 删除: `AllIcons.Actions.Cancel`
- 复制: `AllIcons.Actions.Copy`
- 设置: `AllIcons.General.Settings`
- 预览: `AllIcons.Actions.Preview`
- 垃圾桶: `AllIcons.Actions.GC`

## 用户体验优化

1. **即时反馈**: 所有操作立即显示结果
2. **错误处理**: 友好的错误消息对话框
3. **状态持久化**: 服务器状态跨会话保存
4. **自动刷新**: 请求日志自动更新
5. **快速操作**: 一键复制 URL
6. **多地址显示**: 方便局域网访问
